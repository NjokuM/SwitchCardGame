<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 920 580">
  <!-- Background box -->
  <rect width="920" height="580" fill="#000000" />
  
  <!-- Inner background with margin -->
  <rect x="10" y="10" width="900" height="560" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="450" y="40" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle">Power Card System Design</text>
  
  <!-- Flowchart Components -->
  <!-- Top box: Game Manager -->
  <rect x="350" y="60" width="200" height="60" rx="5" ry="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="2" />
  <text x="450" y="95" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">GameManager</text>
  
  <!-- Arrow Down -->
  <path d="M 450,120 L 450,140" stroke="#1565c0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- Power Card Detector -->
  <rect x="350" y="140" width="200" height="60" rx="5" ry="5" fill="#e8f5e9" stroke="#388e3c" stroke-width="2" />
  <text x="450" y="175" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Power Card Detection</text>
  
  <!-- Arrow Down -->
  <path d="M 450,200 L 450,230" stroke="#388e3c" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- Effects Handler -->
  <rect x="350" y="230" width="200" height="60" rx="5" ry="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" />
  <text x="450" y="265" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Effect Handler</text>
  
  <!-- Arrows to Card Types -->
  <path d="M 350,260 L 110,280" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 370,290 L 270,290" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 430,290 L 430,280" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 470,290 L 470,280" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 530,290 L 590,290" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 550,260 L 750,280" stroke="#9c27b0" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- Card Types -->
  <rect x="40" y="280" width="140" height="60" rx="5" ry="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="110" y="315" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Ace</text>
  <text x="110" y="335" font-family="Arial" font-size="12" text-anchor="middle">Change Suit</text>
  
  <rect x="200" y="280" width="140" height="60" rx="5" ry="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="270" y="315" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">2</text>
  <text x="270" y="335" font-family="Arial" font-size="12" text-anchor="middle">Draw Two Cards</text>
  
  <rect x="360" y="280" width="140" height="60" rx="5" ry="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="430" y="315" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">7</text>
  <text x="430" y="335" font-family="Arial" font-size="12" text-anchor="middle">Skip Turn</text>
  
  <rect x="520" y="280" width="140" height="60" rx="5" ry="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="590" y="315" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">8</text>
  <text x="590" y="335" font-family="Arial" font-size="12" text-anchor="middle">Reverse Direction</text>
  
  <rect x="680" y="280" width="140" height="60" rx="5" ry="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="750" y="315" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Jack</text>
  <text x="750" y="335" font-family="Arial" font-size="12" text-anchor="middle">Play Again</text>
  
  <!-- Special Cards (Hearts) -->
  <rect x="100" y="360" width="200" height="60" rx="5" ry="5" fill="#ffebee" stroke="#d32f2f" stroke-width="2" />
  <text x="200" y="385" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">King of Hearts</text>
  <text x="200" y="405" font-family="Arial" font-size="12" text-anchor="middle">Next Player Draws 5 Cards</text>
  
  <rect x="320" y="360" width="200" height="60" rx="5" ry="5" fill="#ffebee" stroke="#d32f2f" stroke-width="2" />
  <text x="420" y="385" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">5 of Hearts</text>
  <text x="420" y="405" font-family="Arial" font-size="12" text-anchor="middle">Cancel King of Hearts Effect</text>
  
  <rect x="540" y="360" width="200" height="60" rx="5" ry="5" fill="#ffebee" stroke="#d32f2f" stroke-width="2" />
  <text x="640" y="385" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">2 of Hearts</text>
  <text x="640" y="405" font-family="Arial" font-size="12" text-anchor="middle">Convert 5 to 7 Cards</text>
  
  <!-- Heart Card Connection -->
  <path d="M 200,440 L 420,440" stroke="#d32f2f" stroke-width="2" fill="none" />
  <path d="M 420,440 L 640,440" stroke="#d32f2f" stroke-width="2" fill="none" />
  <path d="M 200,420 L 200,440" stroke="#d32f2f" stroke-width="2" fill="none" />
  <path d="M 420,420 L 420,440" stroke="#d32f2f" stroke-width="2" fill="none" />
  <path d="M 640,420 L 640,440" stroke="#d32f2f" stroke-width="2" fill="none" />
  <text x="420" y="455" font-family="Arial" font-size="12" font-weight="bold" fill="#d32f2f" text-anchor="middle">Special Interaction Chain</text>
  
  <!-- Game State Update -->
  <rect x="350" y="470" width="200" height="60" rx="5" ry="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="2" />
  <text x="450" y="505" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Game State Update</text>
  
  <!-- Connecting Arrows -->
  <path d="M 270,340 L 350,470" stroke="#ff9800" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 430,340 L 410,470" stroke="#ff9800" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 590,340 L 450,470" stroke="#ff9800" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
  <path d="M 420,420 L 420,470" stroke="#d32f2f" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- Arrow back to Game Manager -->
  <path d="M 550,500 L 600,500 L 600,90 L 550,90" stroke="#1565c0" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
  <text x="620" y="300" font-family="Arial" font-size="12" font-weight="bold" fill="#1565c0" text-anchor="middle">State Feedback Loop</text>
  
  <!-- Figure number -->
  <text x="450" y="540" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Figure 21: Power Card System Design</text>
  
  <!-- Arrow Definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#757575" />
    </marker>
  </defs>
</svg>